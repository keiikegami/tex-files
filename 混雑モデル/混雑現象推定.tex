\documentclass{jsarticle}
\usepackage[margin = .7in]{geometry}
\usepackage[dvipdfmx]{graphicx}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{bm}
\lstset{%
  language={python},
  basicstyle={\small},%
  identifierstyle={\small},%
  commentstyle={\small\itshape},%
  keywordstyle={\small\bfseries},%
  ndkeywordstyle={\small},%
  stringstyle={\small\ttfamily},
  frame={tb},
  breaklines=true,
  columns=[l]{fullflexible},%
  numbers=left,%
  xrightmargin=0zw,%
  xleftmargin=3zw,%
  numberstyle={\scriptsize},%
  stepnumber=1,
  numbersep=1zw,%
  lineskip=-0.5ex%
}

\begin{document}
\title{卒論テーマ候補 ：混雑現象の構造推定}
\author{池上　慧}
\maketitle

\section{研究目的}
Viauroux (2007)や柳沼・福田(2007,8)、松村他などが交通手段の選択と通勤に利用する電車の出発時間選択においてプレイヤー同士の影響を考慮したゲームのモデルを用いたパラメータの推定を行っている。またその結果においては混雑による不効用を示すパラメータは有意に負の値を取っている。主に用いられていた推定手法はAgurregabiria (2004)のPMLであり、Kasahara and Shimotsu(2012?)にのっとって推定結果が収束するようにしている。

上記の研究ではプレイヤーについての情報が得られている時にプレイヤーごとに選択確率を計算することでベイジアンナッシュ均衡を計算し、推定に用いている。しかし、松村他で用いられたのはサンプルサイズの小さいセンサスデータであり、また個人の通勤時間などについては別種の統計データから推計したものを利用している。ここではこのような個人のデータによらずに混雑現象を推定できるかを考える。

例えば、松村他で扱われた満員電車に選択モデルを考えると、個人ごとにどのような人がいつどの電車に乗ったかというデータを得るのは非現実的である。そのようなデータの代わりに何時の電車に何人が乗ったという現実的に得られるデータのみを用いて推定できるモデルを作ることは有用であると考える（本当？）。

現実に存在する混雑現象としては、上で述べた満員電車の他にも、入試の受験料を収入源とする私立大学群による入試日の設定や、テーマパークへの来場日の決定、コンピュータ上の分散処理などが挙げられる。このようなテーマで実際にモデルを推定する。

\section{モデル}
\subsection{基本のモデル}
電車の候補が全部で$M$本とし、$j \in M$で各電車を指すとする。プレイヤーは$N$人で$i$をインデックスとする。プレイヤー$i$が電車$j$に乗車することの効用$(V_j^i)$は、その電車の発車時刻$(t_j)$に紐付いた$i$ごとに異なる価値$(u_j^i)$と、その電車に乗車するプレイヤーの数$(N_j)$に依存して決定する。ただし$\left\{u_j^i\right\}$は自身の持つ各電車への価値は自分で認識できるが、自分以外のプレイヤーが持つ各電車への価値は認識できないとする。ここでそれぞれの効用への寄与は分離できるとして、
\begin{align*}
	V_j^i = u_j^i + g(N_j)
\end{align*}
で書くことができるとする。

しかし、実際に乗車する電車を決定する際には、実現する乗車人数$N_j$に基づいて意思決定することはできない。なぜならまだその人数は実現していないからである。そのため、$N_j$についての期待値に基づいて意思決定を下すことになる。ここで、プレイヤー同士にも、経済学者にも観測できない撹乱項$\epsilon_j^i$が電車とプレイヤーについて独立に第1種極値分布にしたがうと仮定し、$additive$に効用に影響するとする。すなわち、
\begin{align*}
	h_j^i = V_j^i + \epsilon_j^i = u_j^i + g(N_j) + \epsilon_j^i
\end{align*}
でプレイヤー$i$の持つ電車$j$の効用をかけるとし、$N_j$について期待値をとった形で
\begin{align*}
	{h_j^i}^* = {V_j^i}^* + \epsilon_j^i = u_j^i + E[g(N_j)] + \epsilon_j^i
\end{align*}
と書くとする。
この時、$g(N_k) = \alpha N_k$として特定化すると、プレイヤー$i$が電車$j$を選ぶ確率は以下のようにかける。
\begin{align*}
	p_j^i = Pr(\text{i chooses j}) = P({h_j^i}^* \geq {h_{j^{'}}^i}^*\ \text{for all}\ j \in M) = \frac{\exp({V_j^i}^*)}{\sum_k \exp({V_k^i}^*)} = \frac{\exp(u_j^i + \alpha E[N_j])}{\sum_k \exp(u_k^i + \alpha E[N_k])}
\end{align*}

\subsection{$N$人$2$物ゲーム}
$N$人$2$電車の状況を考える。Brock and Durlauf (2001)で記述されているようなモデルを考えていく。
$p_k^i$で、プレイヤー$i$が電車$k$に対して持つ選択傾向を表すとする。第1種極値分布に従う撹乱項を用いてそれぞれの電車に対する選択傾向を以下のように書ける。
\begin{align*}
	\begin{cases}
	p_1^1 &= \frac{\exp(u_1^1 + \alpha E^*)}{\exp(u_1^1 + \alpha E^*) + \exp(u_2^1 + \alpha(N - E^*))}\\[8pt]
	\vdots\\[8pt]
	p_1^N &= \frac{\exp(u_1^N + \alpha E^*)}{\exp(u_1^N + \alpha E^*) + \exp(u_2^N + \alpha(N - E^*))}
	\end{cases}
\end{align*}
この時$E^*$は以下で述べていく意味での均衡における電車$1$に乗車した人の数であるとする。この選択傾向が$\frac{1}{2}$を上回れば電車$1$を選択し、下回れば電車$2$を選択するとして行動を記述する。この時、プレイヤー$i \in \left\{ 1, \cdots, N\right\}$について、電車$2$を選ぶということは
\begin{align*}
	p_1^i < \frac{1}{2}\ &\Leftrightarrow\ \frac{\exp(u_1^1 + \alpha E^*)}{\exp(u_1^1 + \alpha E^*) + \exp(u_2^1 + \alpha(N - E^*))} < \frac{1}{2}\\[8pt]
	&\Leftrightarrow\ u_2^i - u_1^i > 2\alpha E^* - \alpha N\\[8pt]
	&\Leftrightarrow\ d_i > 2\alpha E^* - \alpha N
\end{align*}
である。ただし$d_i = u_2^i - u_1^i$としている。ここで$\forall i\ d_i \sim N(0,\sigma^2)$とおくと、$Pr(d_i > \alpha(2E^* - N)) = 1 - \Phi \left(\frac{\alpha}{\sigma}(2 E^* - N)\right)$で書くことができる。以上より均衡における電車$1$に乗る人の期待値$ E^*$は、
\begin{align*}
	N - E^* =  N(1 - \Phi \left(\frac{\alpha}{\sigma}(2 E^* - N)\right))\ \Leftrightarrow\  E^* = N\Phi \left(\frac{\alpha}{\sigma}(2 E^* - N)\right)
\end{align*}
をを満たすことがわかる。つまり$N \Phi \left(\frac{\alpha}{\sigma}(2 E - N)\right)$であり、ここで$e^* = \frac{E^*}{N}$すると$e^* = \Phi \left(\frac{\alpha}{\sigma}N(2e^* - 1) \right)$を均衡の$e^*$は満たすことになる。

今、$v = e - \Phi \left(\frac{\alpha}{\sigma}N(2e - 1) \right)$とおくと、$\alpha < 0$であるという想定の下では、
\begin{align*}
	\frac{\partial v}{\partial e} = 1 - \frac{2\alpha N}{\sigma}\phi \left( \frac{\alpha}{\sigma}N(2e - 1) \right) > 1
\end{align*}
を得るので、$v$は$e$についての単調増加関数である。従ってこのモデルの均衡はただ一つであり、$e = \frac{1}{2}$において先の等式が成立することから、$e^* = \frac{1}{2}$が唯一の均衡である。この時$\alpha$がどのような値でも同じ均衡がモデルから得られるのでパラメータの識別は行えない。


\section{シミュレーションデータでの推定}

\section{実験データでの推定}

\section{実証研究}
入試日程の設定と満員電車


\end{document}



























\documentclass{article}
\usepackage[margin = .7in]{geometry}
\usepackage[dvipdfmx]{graphicx}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{bm}
\usepackage{mathrsfs}
\lstset{%
  language={python},
  basicstyle={\small},%
  identifierstyle={\small},%
  commentstyle={\small\itshape},%
  keywordstyle={\small\bfseries},%
  ndkeywordstyle={\small},%
  stringstyle={\small\ttfamily},
  frame={tb},
  breaklines=true,
  columns=[l]{fullflexible},%
  numbers=left,%
  xrightmargin=0zw,%
  xleftmargin=3zw,%
  numberstyle={\scriptsize},%
  stepnumber=1,
  numbersep=1zw,%
  lineskip=-0.5ex%
}

\begin{document}
\title{測度論的確率論 2018 S1S2 \\ 
Homework 7}
\author{経済学研究科現代経済コース修士1年 / 池上　慧 (29186009) / sybaster.x@gmail.com}
\maketitle

\section{Theorem 7.2}
まず$P(\epsilon_i = 0) = P(\epsilon_i = 1) = \frac{1}{2}$を示す。$\epsilon_i \in \left\{ 0,1\right\}$なので、$1$となる確率のみ求めれば良い。$i = 1$の時は、
\begin{align*}
	P(\epsilon_1 = 1) = P\left(\omega \mid \omega \in \left[\frac{1}{2}, 1\right)\right) = \frac{1}{2}
\end{align*}
より確かに成り立つ。$i > 1$の時は、
\begin{align*}
	P(\epsilon_i = 1) = 2^{i-1} \times \frac{1}{2^i} = \frac{1}{2}
\end{align*}
ここで$2^{i-1}$は$\left\{ \epsilon_j \right\}_{j = 1}^{i-1}$が取りうる場合の数であり、$\frac{1}{2^i}$は実現した$\left\{ \epsilon_j \right\}_{j=1}^{i-1}$に対して$\left\{ \epsilon_j \right\}_{j =i}^{\infty}$を使って表現できる$\omega$の集合の測度である。ここでは$\omega$が一様分布であるので、$P\left(\omega \mid \omega \in \left[0, \frac{1}{2^i}\right) \right) = \frac{1}{2^i}$である。よって確かに任意の$i$について$P(\epsilon_i = 0) = P(\epsilon_i = 1) = \frac{1}{2}$が確かめられた。

次に独立性を示す。$D_i \in \left\{ 0,1\right\}$として、任意の$\left\{ i_1, i_2, \cdots, i_m \right\} \subset \mathbb{N}$に対して以下が成立することを示す。
\begin{align*}
	P\left( \epsilon_{i_1} = D_1, \cdots, \epsilon_{i_m} = D_m \right) = P\left( \epsilon_{i_1} = D_1\right) \times \cdots \times P\left( \epsilon_{i_m} = D_,\right)
\end{align*}
先の結果より、右辺は$\frac{1}{2^m}$なので、左辺もこの値を取ることを示せばよい。先と同じように考えて以下をえる。
\begin{align*}
	P\left( \epsilon_{i_1} = D_1, \cdots, \epsilon_{i_m} = D_m \right) = 2^{i_m - m} \times \frac{1}{2^{i_m}} = \frac{1}{2^m}
\end{align*}
ここで$2^{i_m - m}$は小数第$i_m$位までに自由に動かせる桁を組み合わせた時の場合の数であり、$\frac{1}{2^{i_m}}$は各組み合わせに対して動かせる幅の測度である。よって題意は示された。


\section{Ex 7.1}
レクチャーノートより$\left\{ X_n \mid n \in \mathbb{N}\right\}$が独立であることは以下と同値である。
\begin{align*}
	\forall \left\{ i_1, i_2, \cdots, i_m \right\} \subset \mathbb{N},\ L\left( X_{i_1}, \cdots, X_{i_m} \right) = L\left( X_{i_1} \right)\times \cdots \times L\left( X_{i_m} \right)
\end{align*}
従って$\left\{ X_n \mid n \in \mathbb{N}\right\}$が独立の時、任意の$n \in \mathbb{N}$に対して、
\begin{align*}
	L\left( X_1, \cdots, X_n \right) \times L(X_{n+1}) &= L\left( X_{1} \right)\times \cdots \times L\left( X_{n} \right) \times L\left( X_{n+1} \right)\\
	&= L\left( X_1, \cdots, X_n, X_{n+1} \right)\\ &= L\left( \left(X_1, \cdots, X_n\right), X_{n+1} \right)
\end{align*}
なので確かに$\left(X_1, \cdots, X_n\right)$と$X_{n+1}$は独立である。また逆に、任意の$n$について$\left(X_1, \cdots, X_n\right)$と$X_{n+1}$が独立の時、
\begin{align*}
	L\left( \left(X_1, \cdots, X_n\right), X_{n+1} \right) &= L\left( X_1, \cdots, X_n \right) \times L(X_{n+1})\\
	&= L\left( \left(X_1, \cdots, X_{n-1}\right), X_n \right) \times L(X_{n+1})\\
	&= L\left( \left(X_1, \cdots, X_{n-1}\right)\right) \times L(X_{n}) times L(X_{n+1})\\
	& \vdots\\
	&= L\left( X_1 \right)\times \cdots \times L\left( X_{n+1} \right)
\end{align*}
が成立する。任意に$\left\{ i_1, i_2, \cdots, i_m \right\} \subset \mathbb{N}$をとった時、上記の議論より$\left( X_1, \cdots, X_{i_m} \right)$が独立なので、そのサブセットによって構成される$\left( X_{i_1}, \cdots, X_{i_m} \right)$も独立となる。

\section{Ex 7.3}
$X$と同じ確率変数をもう一つ用意し$Y$とする。この時分布を$\mu(x),\mu(y)$と書いて以下の積分を考える。
\begin{align*}
	\int_{\mathbb{R}}\int_{\mathbb{R}} \left( f(x) - f(y) \right)  \left( g(x) - g(y)\right) \mathrm{d}\mu(x) \mathrm{d}\mu(y)
\end{align*}
$f,g$はどちらも非減少関数であるので、$x \geq y$の時は$f(x) - f(y), g(x) - g(y) \geq 0$であり、$x < y$の時は$f(x) - f(y), g(x) - g(y) \leq 0$である。これより被積分関数は常に非負であることがわかる。従って上記の積分は非負である。$x,y$は同一視できるので、積分の線型性より以下を得る。
\begin{align*}
	\int_{\mathbb{R}}\int_{\mathbb{R}} \left( f(x) - f(y) \right)  \left( g(x) - g(y)\right) \mathrm{d}\mu(x) \mathrm{d}\mu(y) = 2 E \left[ f(x)g(x) \right] - 2E\left[ f(x) \right] E\left[ g(y) \right]
\end{align*}
これより、
\begin{align*}
	2 E \left[ f(x)g(x) \right] - 2E\left[ f(x) \right] E\left[ g(x) \right] \geq 0\ \Leftrightarrow\ E \left[ f(x)g(x) \right] \geq E\left[ f(x) \right] E\left[ g(x) \right]
\end{align*}

また、$g$が非増加関数の時、$-g$が非減少関数であり、上記が適用できる。
\begin{align*}
	E \left[ -f(x)g(x) \right] \geq E\left[ f(x) \right] E\left[ -g(x) \right] \ \Leftrightarrow\ E \left[ f(x)g(x) \right] \leq E\left[ f(x) \right] E\left[ g(x) \right]
\end{align*}
よって題意は示された。

\section{Ex 7.8}
まず連続性を示す。$z, z^{\prime} \in \mathbb{R}$をとる。積分の線型性とEx 4.3より以下を得る。
\begin{align*}
	\left| f\star g(z) - f\star g(z^{\prime}) \right| \leq \int \left| f(z-y) - f(z^{\prime} -y) \right| \left| g(y) \right| \mathrm{d}y
\end{align*}
ここで関数に対して以下を定義する。ただし$\mu$は関数の定義域に対して定義された測度である。
\begin{align*}
	\| g \|_{\infty}  = \inf \left\{ C \mid \mu\left( \left\{ \left| g \right| > C \right\} \right) = 0 \right\}
\end{align*}
これを用いて、
\begin{align*}
	\int \left| f(z-y) - f(z^{\prime} -y) \right| \left| g(y) \right| \mathrm{d}y \leq \| g \|_{\infty} \int \left| f(z-y) - f(z^{\prime} -y) \right| \mathrm{d}y
\end{align*}
である。仮定より$\| g \|_{\infty} < \infty$であるので、$\left| z-z^{\prime} \right| < \delta$ならば$\int \left| f(z-y) - f(z^{\prime} -y) \right| \mathrm{d}y$が任意に小さい$\epsilon > 0$で抑えられるような、$\delta$が存在することを示せば定義より連続性が示されたことになる。以下ではこれを示す。

$z^{\prime} - y = w$で変数変換し、適当な$R > 0$に対して$B_R = [-R, R]$と定義して、三角不等式より以下を得る。
\begin{align}
	\int \left| f(z-y) - f(z^{\prime} -y) \right| \mathrm{d}y &= \int \left| f(z-z^{\prime}+w) - f(w) \right| \mathrm{d}w \nonumber \\[8pt]
	&\leq \int \left| \left( f(z-z^{\prime}+w) - f(w)\right) 1_{B_R} \right| \mathrm{d}w + \int \left| \left( f(z-z^{\prime}+w) - f(w)\right) 1_{B_R^c} \right| \mathrm{d}w
\end{align}
ここで$\left| z-z^{\prime} \right| < \frac{R}{2}$の時、第2項は以下のように抑えられる。
\begin{align*}
	\int \left| \left( f(z-z^{\prime}+w) - f(w)\right) 1_{B_R^c} \right| \mathrm{d}w \leq \int \left| f(z-z^{\prime}+w)1_{B_R^c} \right| \mathrm{d}w + \int \left| f(w)1_{B_R^c} \right| \mathrm{d}w \leq 2\left( \int \left| f(w)1_{B_{\frac{R}{2}}^c} \right| \mathrm{d}w \right)
\end{align*}
なぜなら、$\left| z-z^{\prime} \right| < \frac{R}{2}$の時、$w \in B_R^c\ \Rightarrow\ z-z^{\prime}+w \in B_{\frac{R}{2}}^c$となるからである。仮定より$f$は可積分関数なので、単調収束定理が適用でき、
\begin{align*}
	\lim_{R\to \infty} \int \left| f(w)1_{B_{\frac{R}{2}}^c} \right| \mathrm{d}w = 0
\end{align*}
すなわち、
\begin{align}
	\forall \epsilon > 0, \exists R_{\epsilon} > 0\ \text{s.t.}\ \forall R> R_{\epsilon},  \int \left| f(w)1_{B_{\frac{R}{2}}^c} \right| \mathrm{d}w \leq \epsilon
\end{align}
を得る。

次に$(1)$の第1項を抑えることを考える。まず、Ex 4.21より、任意の$\epsilon > 0$に対して、
\begin{align*}
	\int \left| f- \phi_{\epsilon} \right| \mathrm{d}x < \epsilon
\end{align*}
を満たすようなコンパクトな台を持つ連続関数$\phi_{\epsilon}$が必ず存在する。この関数を使って以下のように抑える。
\begin{align}
	\int \left| \left( f(z-z^{\prime}+w) - f(w)\right) 1_{B_R} \right| \mathrm{d}w &\leq \int \left| \left( f(z-z^{\prime} +w) - \phi_{\epsilon}(z-z^{\prime} +w) \right)1_{B_R} \right| \mathrm{d}w \nonumber \\&\quad +  \int \left| \left( \phi_{\epsilon}(z-z^{\prime} +w) - \phi_{\epsilon}(w) \right)1_{B_R} \right| \mathrm{d}w \nonumber \\ &\quad +  \int \left| \left( \phi_{\epsilon}(w) - f(w) \right)1_{B_R} \right| \mathrm{d}w \nonumber \\[8pt]
	&\leq 2\epsilon + \int \left| \left( \phi_{\epsilon}(z-z^{\prime} +w) - \phi_{\epsilon}(w) \right)1_{B_R} \right| \mathrm{d}w
\end{align}
$\phi_{\epsilon}(x)$はその定義より以下を満たす。$R > R_{\epsilon}$を固定して、任意の$\epsilon > 0$に対して
\begin{align*}
	\exists \delta_{\epsilon, R} > 0\ \text{s.t.}\ \forall y \in \mathbb{R}, \left| x \right| < \delta_{\epsilon, R}, \left| \phi_{\epsilon}(x + y)- \phi_{\epsilon}(y) \right| \leq \frac{\epsilon}{2R}
\end{align*}
である。従って、各$R$に対して$\left| z-z^{\prime} \right| < \delta_{\epsilon, R}$で、
\begin{align}
	\int \left| \left( \phi_{\epsilon}(z-z^{\prime} +w) - \phi_{\epsilon}(w) \right)1_{B_R} \right| \mathrm{d}w \leq \int \frac{\epsilon}{2R} 1_{B_R}\mathrm{d}w = \epsilon
\end{align}
とする事ができる。$(1)$に$(2),(3),(4)$の結果を使って、
\begin{align*}
	\forall \epsilon > 0, \exists \delta > 0\ \text{s.t.}\  z, z^{\prime} \in \mathbb{R}, \left| z-z^{\prime} \right| < \delta\ \Rightarrow\ \int \left| f(z-y) - f(z^{\prime} -y) \right| \mathrm{d}y \leq 5\epsilon
\end{align*}
以上より確かに上の項を任意に小さくできるので連続性が示された。

次に有界であることを示す。$f$が確率密度関数であり非負であることと、変数変換公式より、
\begin{align*}
	\left| f\star g(z) \right| \leq \int \left| f(z-y) g(y) \right| \mathrm{d}y \leq \| g \|_{\infty} \int f(z-y) \mathrm{d}y = \| g \|_{\infty} < \infty
\end{align*}
を得る。従って今考えている畳み込みが有界であることが示された。

\section{ 2.1.10}
積分の線型性と二つの確率変数が独立であることより以下を得る。
\begin{align*}
	P(X+Y = n) &= E\left[ 1(x + y = n) \right] = E\left[ \sum_m 1(x = m) 1(y = n-m) \right]\\ &= \sum_m E\left[ 1(x = m) 1(y = n-m) \right] = \sum_m E\left[ 1(x = m) \right] E\left[1(y = n-m) \right] = \sum_m P(X = m) P(Y = n-m)\\[8pt]
\end{align*}

\section{Durrett 2.1.11}
前問より以下が成立する。
\begin{align*}
	P(X+Y = n) &= \sum_m P(X = m) P(Y = n-m) = \sum_m \frac{e^{-\lambda} \lambda^m}{m!} \frac{e^{-\mu} \mu^{(n-m)}}{(n-m)!}\\[8pt]
	&=\frac{e^{-(\lambda + \mu) (\lambda + \mu)^n}}{n!} \sum_m \frac{n!}{(\lambda + \mu)^n} \frac{\lambda^m \mu^{(n-m)}}{m! (n-m)!}\\[8pt]
	&= \frac{e^{-(\lambda + \mu) (\lambda + \mu)^n}}{n!} \underbrace{\sum_m \binom nm \left( \frac{\lambda}{\lambda + \mu} \right)^m \left( 1 - \frac{\lambda}{\lambda + \mu} \right)^{(n-m)}}_{\star}\\[8pt]
	&= \frac{e^{-(\lambda + \mu) (\lambda + \mu)^n}}{n!} 
\end{align*}
ただし最後の等式$\star$部が二項分布の確率分布関数の和となっており、$\star = 1$であることによって得られる。よって題意は示された。

\end{document}


















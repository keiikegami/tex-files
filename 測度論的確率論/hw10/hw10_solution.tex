\documentclass{article}
\usepackage[margin = .7in]{geometry}
\usepackage[dvipdfmx]{graphicx}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{bm}
\usepackage{mathrsfs}
\lstset{%
  language={python},
  basicstyle={\small},%
  identifierstyle={\small},%
  commentstyle={\small\itshape},%
  keywordstyle={\small\bfseries},%
  ndkeywordstyle={\small},%
  stringstyle={\small\ttfamily},
  frame={tb},
  breaklines=true,
  columns=[l]{fullflexible},%
  numbers=left,%
  xrightmargin=0zw,%
  xleftmargin=3zw,%
  numberstyle={\scriptsize},%
  stepnumber=1,
  numbersep=1zw,%
  lineskip=-0.5ex%
}

\begin{document}
\title{測度論的確率論 2018 S1S2 \\ 
Homework 10}
\author{経済学研究科現代経済コース修士1年 / 池上　慧 (29186009) / sybaster.x@gmail.com}
\maketitle

\section{3.2.1}
\begin{align*}
	f_n(x) = \begin{cases} 0 & \text{when $\left[ 2^n x \right]$ is even}\\[8pt]
	2 & \text{when $\left[ 2^n x \right]$ is odd}
	\end{cases}
\end{align*}
なる関数列を考える。ただし$\left[ x \right]$は$x$を超えない最大の整数を表す記号とする。この時、任意の$n$について$f_n(x)$は$0,2$のいずれかしか取り得ないので、明らかに$n \to \infty$で$f_n(x) \neq 1 ,\forall x \in \mathbb{R}$である。しかし分布関数を考えると、任意の$x \in \mathbb{R}$を考えると、
\begin{align*}
	F_n(x) = \int_0^x f_n(y) \mathrm{d}y = \begin{cases} \frac{\left[ 2^n x \right] - 1}{2} \times 2 \times \frac{1}{2^n} + 2\left( x - \frac{\left[ 2^n x \right]}{2^n} \right) & \text{when $\left[ 2^n x \right]$ is odd} \\[8pt]
	\frac{\left[ 2^n x \right] }{2} \times 2 \times \frac{1}{2^n}  & \text{when $\left[ 2^n x \right]$ is even}
	\end{cases}
\end{align*}
である。前者は整理すると$2x - \frac{1 + \left[ 2^n x \right]}{2^n}$であり、$2^n x - 1 \leq \left[ 2^n x \right] \leq 2^n x$なので、
\begin{align*}
	x - \frac{1}{2^n}\leq 2x - \frac{1 + \left[ 2^n x \right]}{2^n} \leq x
\end{align*}
であり、はさみうちの原理から$n \to \infty$で$x$に収束する。また後者についても同様の議論から、
\begin{align*}
	x-\frac{1}{2^n} \leq \frac{\left[ 2^n x \right]}{2^n} \leq x
\end{align*}
となるのでこちらも$x$に収束する。従って、$x \in \mathbb{R}$に各点で分布関数$F_n$が一様分布の分布関数に収束するので分布収束していることがわかる。

\section{3.2.6}
\subsection{距離の公理}
まず距離の公理を満たすことを確認する。

\subsubsection{対称性}
$y = x - \epsilon, z = x + \epsilon$と置くと、
\begin{align*}
	\left\{ \epsilon \mid F(x-\epsilon) - \epsilon \leq G(x) \leq F(x+\epsilon) + \epsilon, \forall x \right\} &= \left\{ \epsilon \mid F(y) \leq G(y + \epsilon) + \epsilon\ \text{and}\  G(z-\epsilon) - \epsilon \leq F(z), \forall y , z\right\} \\
	&= \left\{ \epsilon \mid G(x - \epsilon) - \epsilon \leq F(x) \leq G(x + \epsilon) + \epsilon, \forall x \right\}
\end{align*}
であるので$\inf$を取る対象となる集合が変わらないため$\rho\left( F, G \right) = \rho\left( G, F \right)$である。

\subsubsection{非負性}
$\rho\left( F, G \right) < 0$とすると実数の連続性より$\rho\left( F, G \right) < \alpha < 0$なる実数$\alpha$が必ず存在し、この時以下が満たされる。
\begin{align*}
	\forall x, F\left( x - \alpha \right) - \alpha \leq G(x) \leq F\left( x + \alpha \right) + \alpha
\end{align*}
しかし、$x - \alpha > x > x + \alpha$であるので、分布関数の定義より$F(x-\alpha) \geq F(x + \alpha)$であり、さらに$F(x-\alpha) -\alpha \geq F(x + \alpha) + \alpha$である。これは先と矛盾するので$\rho\left( F, G \right) \geq 0$である。

\subsubsection{$\rho\left( F, G \right)  =  0 \Leftrightarrow F = G$}
$(\Leftarrow part)$ 
\begin{align*}
	\rho\left( F, G \right) = \inf\left\{ \epsilon \mid F(x-\epsilon) - \epsilon \leq F(x) \leq F(x+\epsilon) + \epsilon, \forall x \right\}
\end{align*}
任意の$\epsilon \geq 0$について$F(x-\epsilon) \leq F(x), F(x + \epsilon) \geq F(x)$であるので、$\inf$を取る集合は任意の$\epsilon \geq 0$を含む。非負であることは先に示したので、この時確かに$\rho\left( F, G \right)  =  0$である。

\noindent $(\Rightarrow part)$
\begin{align*}
	F(x - \epsilon) - \epsilon \leq G(x) \leq F(x + \epsilon) + \epsilon
\end{align*}
に対して$\epsilon \to 0$とすると、仮定より$F(x_{-}) \leq G(x) \leq F(x_{+})$が成立する。これより、もし$x$が$F$の連続点であれば、$G(x) = F(x)$である。また、もし$x$が連続点でない場合出会っても、不連続点が高々可算個しかないことから上から不連続点$x$に近づく連続点の列$\left\{ x_m \right\}$を考えることができ、分布関数の右連続性と、連続点においては$F.G$が等しいという先の結果より、
\begin{align*}
	G(x) = G(x_{+}) = \lim_{x_m \downarrow x} G(x_m) = \lim_{x_m \downarrow x} F(x_m) = F(x_{+}) = F(x)
\end{align*}
となり、不連続点においても$F = G$となることが確認できる。

\subsubsection{三角不等式}
三つの分布関数$F,G,H$について、
\begin{align*}
	\rho\left( F, G \right) + \rho\left( G, H \right) \geq \rho\left( F, H \right)
\end{align*}
が成立することを示す。まず、$\rho\left( F, G \right) = \epsilon_1, \rho\left( G, H \right) = \epsilon_2, \epsilon = \epsilon_1 + \epsilon_2$と置く。この時任意の$x$について、
\begin{align*}
	F\left( x - \epsilon \right) - \epsilon = F\left(x - \epsilon_1 - \epsilon_2 \right) - \epsilon_1 - \epsilon_2 \leq G\left( x - \epsilon_2 \right) - \epsilon_2 \leq H(x)
\end{align*}
が成立する。ただし一つ目の不等号は$\epsilon_1$の定義より二つめの不等号は$\epsilon_2$の定義より得られる。同様にして、
\begin{align*}
	F\left( x + \epsilon \right) + \epsilon = F\left(x + \epsilon_1 + \epsilon_2 \right) +\epsilon_1 + \epsilon_2 \geq G\left( x + \epsilon_2 \right) + \epsilon_2 \geq H(x)
\end{align*}
も得られる。以上より、
\begin{align*}
	F\left( x - \epsilon \right) - \epsilon \leq H(x) \leq F\left( x + \epsilon \right) + \epsilon
\end{align*}
が任意の$x$について満たされるので、$\rho\left( F, H \right)$は$\epsilon$以下の値となることがわかる。以上より題意の不等式が示された。

\subsection{分布収束との同値性}
次に$\rho\left( F_n, F \right) \to 0\ \Leftrightarrow\ F_n \xrightarrow{w} F$を示す。

\noindent $(\Rightarrow part)$



\section{3.2.9}
「分布関数$F$が連続であるならば$F$は一様連続である（主張$1$）」を所与とする。この時、
\begin{align*}
	\forall \epsilon > 0, \exists \delta > 0, \text{s.t.}\ |x-y| \leq \delta\ \Rightarrow\ \left| F(x) - F(y) \right| \leq \epsilon
\end{align*}
である。$F_n \Rightarrow F$であるのでEx 3.2.6.より$\rho\left( F_n, F \right) \to 0$である。すなわち一般性を失うことなく、$\epsilon \geq \delta \geq 0$に対して、
\begin{align*}
	F\left( x-\delta \right) -\delta \leq F_n(x) \leq F(x + \delta) + \delta
\end{align*}
である。ここで、$|x - (x-\delta)| \leq \delta$であるので一様連続性から$\left| F(x) - F(x-\delta) \right| \leq \epsilon$である。すなわち、$F(x) - \epsilon \leq F(x - \delta) \leq F(x) + \delta$である。同様の議論を$x, x+\delta$に対しても適用することで先と合わせて以下を得る。
\begin{align*}
	F(x) - \delta - \epsilon \leq F_n(x) \leq F(x) + \delta + \epsilon
\end{align*}
$\epsilon \geq \delta$であるので、十分大きな$n$において$F(x) - 2\epsilon \leq F_n(x) \leq F(x)+ 2\epsilon$が任意の$\epsilon > 0$に対して任意の$x$で成立することがわかった。すなわち、
\begin{align*}
	\sup_{x\in \mathbb{R}} \left| F_n(x) - F(x) \right| \leq 2\epsilon
\end{align*}
が十分大きな$n$について成立するので題意は示された。

\subsection{主張$1$の証明}
任意に$m \in \mathbb{N}$を取る。これに対して$(0,1)$を$\left( \frac{j-1}{m}, \frac{j}{m} \right), j = 1,\cdots, m$で$m$個に分割することを考える。$F$が連続で非減少関数であるので開集合の逆像は開集合となるので、$F^{-1}\left( \left( \frac{j-1}{m}, \frac{j}{m} \right) \right)$は各$j$について開区間である。この$m$個の区間のルベーグ測度で最小のものを$\delta$とかく。この時、
\begin{align*}
	|x-y| < \delta\ \Rightarrow\ \left| F(x) - F(y) \right| < \frac{2}{m}
\end{align*}
が成立する。なぜなら$x,y$を上のようにとレバ$[x, y]$に最小区間以外の区間が丸々入ることはあり得ないからである。従って、任意の$\epsilon > 0$に対して、$\frac{2}{m} < \epsilon\ \Rightarrow\ \frac{2}{\epsilon} < m$を満たすように$m$をとりその時の最小区間の長さを取ってくれば一様連続性を満たすことがわかる。

\section{3.2.11}
$X_n\ \xrightarrow{w}\ X_{\infty}\ \Rightarrow\ P\left( X_n = m \right) \to P\left( X_{\infty} = m \right)\ \forall m$を示す。$X_n$の分布関数を$F_n$でかくと、$a \in (m-1, m), b \in (m, m+1)$として$P\left( X_n = m \right) = F_n(b) - F_n(a)$である。$X_{\infty}$の分布関数を$F$とかくとすると、仮定より以下を得る。
\begin{align*}
	P\left( X_n = m \right) = F_n(b) - F_n(a) \to F(b) - F(a)
\end{align*}
ここで$b\downarrow m, a\uparrow m$とすることを考えると、
\begin{align*}
	F(b) - F(a) \to F(m_{+}) - F(m_{-}) = P\left( X_{\infty} = m\right)
\end{align*}
従って、$P\left( X_n = m \right) \to P\left( X_{\infty} = m \right)\ \forall m$を得る。

次に$X_n\ \xrightarrow{w}\ X_{\infty}\ \Leftarrow\ P\left( X_n = m \right) \to P\left( X_{\infty} = m \right)\ \forall m$を示す。$G$を$\mathbb{R}$の開集合とする。この時、
\begin{align*}
	\liminf_{n\to \infty} P\left( X_n \in G \right) &= \liminf_{n\to \infty} \sum_{m \in G \cap \mathbb{Z}} P\left( X_n = m \right)\\
	&= \liminf_{n\to \infty} E\left[ 1\left( X_n \in G\cap \mathbb{Z} \right) \right]\\
	&\geq E\left[ \liminf_{n\to \infty} 1\left( X_n \in G\cap \mathbb{Z} \right) \right]\\
	&= \sum_{m \in G \cap \mathbb{Z}} \liminf_{n\to \infty} P\left( X_n = m \right)\\
	&= \sum_{m \in G \cap \mathbb{Z}} P\left( X_{\infty} = m \right)\\
	&= P\left( X_{\infty} \in G\cap \mathbb{Z} \right)
\end{align*}
を得る。ただし、不等号はFatouの補題より得られ、4番目の等号は仮定より得られる。従って、Th 3.2.11(2)より確かに$X_n \xrightarrow{w} X_{\infty}$である。

\section{3.2.12}
まず確率収束するなら分布収束することを示す。まず、
\begin{align*}
	X_n > x\ \text{and}\ |X - X_n| \leq \epsilon\ \Rightarrow\ x-\epsilon < X
\end{align*}
が成立する。これの対偶より$x - \epsilon \geq X\ \Rightarrow\ X_n \leq X\ \text{or}\ |X- X_n| > \epsilon$が成立する。すなわち、
\begin{align*}
	P\left( X \leq x-\epsilon \right) \leq P\left( X_n \leq x \right) + P\left(  |X- X_n| > \epsilon \right)
\end{align*}
である。これより$F(x-\epsilon) - P\left(  |X- X_n| > \epsilon \right) \leq F_n(x)$であり、$X_n \xrightarrow{p}X$であることより左辺第二項は$0$に収束することから、$F(x-\epsilon) \leq \liminf_{n} F_n(x)$である。同じように以下が成立することを使う。
\begin{align*}
	X > x+ \epsilon\ \text{and}\ |X-X_n| \leq \epsilon\ \Rightarrow\ x < X_n
\end{align*}
この対偶は$X_n\leq x\ \Rightarrow\ X\leq x + \epsilon\ \text{or}\ |X-X_n| > \epsilon$であるので、以下を得る。
\begin{align*}
	P\left(X_n\leq x \right) \leq P\left( X\leq x + \epsilon \right) + P\left( |X-X_n| > \epsilon \right)
\end{align*}
仮定より右辺第2項は$0$に収束するので$\limsup_n F_n(x) \leq F(x+\epsilon)$を得る。以上を合わせると、任意の$\epsilon > 0$に対して、
\begin{align*}
	F(x-\epsilon) \leq \liminf_{n} F_n(x) \leq \limsup_n F_n(x) \leq F(x+\epsilon)
\end{align*}
が成立している。$x$が$F$の連続点であるならば、$\epsilon \to 0$とすることを考えて$F(x) = \lim_n F_n(x)$である。また、$x$が$F$の連続点でない場合に関しても、不連続点は高々可算個なので$x$に上から近く連続点の列$\left\{ x_m \right\}$を取ることができる。これに対して、$F, F_n$が右連続であることと、連続点においては収束が示されていることより、
\begin{align*}
	F(x) = \lim_m F(x_m) = \lim_m \lim_n F_n(x_m) = \lim_n F_n(x)
\end{align*}
が成立する。従って各$x$について$\lim_n F_n(x) = F(x)$となっていることが示されたので分布収束することが確かめられた。

\section{3.2.13}

\section{3.2.14}


\end{document}

























\documentclass{article}
\usepackage[margin = .7in]{geometry}
\usepackage[dvipdfmx]{graphicx}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{bm}
\usepackage{mathrsfs}
\lstset{%
  language={python},
  basicstyle={\small},%
  identifierstyle={\small},%
  commentstyle={\small\itshape},%
  keywordstyle={\small\bfseries},%
  ndkeywordstyle={\small},%
  stringstyle={\small\ttfamily},
  frame={tb},
  breaklines=true,
  columns=[l]{fullflexible},%
  numbers=left,%
  xrightmargin=0zw,%
  xleftmargin=3zw,%
  numberstyle={\scriptsize},%
  stepnumber=1,
  numbersep=1zw,%
  lineskip=-0.5ex%
}

\begin{document}
\title{測度論的確率論 2018 S1S2 \\ 
Homework 10}
\author{経済学研究科現代経済コース修士1年 / 池上　慧 (29186009) / sybaster.x@gmail.com}
\maketitle

\section{3.2.1}
\begin{align*}
	f_n(x) = \begin{cases} 0 & \text{when $\left[ 2^n x \right]$ is even}\\[8pt]
	2 & \text{when $\left[ 2^n x \right]$ is odd}
	\end{cases}
\end{align*}
なる関数列を考える。ただし$\left[ x \right]$は$x$を超えない最大の整数を表す記号とする。この時、任意の$n$について$f_n(x)$は$0,2$のいずれかしか取り得ないので、明らかに$n \to \infty$で$f_n(x) \neq 1 ,\forall x \in \mathbb{R}$である。しかし分布関数を考えると、任意の$x \in \mathbb{R}$を考えると、
\begin{align*}
	F_n(x) = \int_0^x f_n(y) \mathrm{d}y = \begin{cases} \frac{\left[ 2^n x \right] - 1}{2} \times 2 \times \frac{1}{2^n} + 2\left( x - \frac{\left[ 2^n x \right]}{2^n} \right) & \text{when $\left[ 2^n x \right]$ is odd} \\[8pt]
	\frac{\left[ 2^n x \right] }{2} \times 2 \times \frac{1}{2^n}  & \text{when $\left[ 2^n x \right]$ is even}
	\end{cases}
\end{align*}
である。前者は整理すると$2x - \frac{1 + \left[ 2^n x \right]}{2^n}$であり、$2^n x - 1 \leq \left[ 2^n x \right] \leq 2^n x$なので、
\begin{align*}
	x - \frac{1}{2^n}\leq 2x - \frac{1 + \left[ 2^n x \right]}{2^n} \leq x
\end{align*}
であり、はさみうちの原理から$n \to \infty$で$x$に収束する。また後者についても同様の議論から、
\begin{align*}
	x-\frac{1}{2^n} \leq \frac{\left[ 2^n x \right]}{2^n} \leq x
\end{align*}
となるのでこちらも$x$に収束する。従って、$x \in \mathbb{R}$に各点で分布関数$F_n$が一様分布の分布関数に収束するので分布収束していることがわかる。

\section{3.2.6}
まず距離の公理を満たすことを確認する。

\subsection{対称性}
$y = x - \epsilon, z = x + \epsilon$と置くと、
\begin{align*}
	\left\{ \epsilon \mid F(x-\epsilon) - \epsilon \leq G(x) \leq F(x+\epsilon) + \epsilon, \forall x \right\} &= \left\{ \epsilon \mid F(y) \leq G(y + \epsilon) + \epsilon\ \text{and}\  G(z-\epsilon) - \epsilon \leq F(z), \forall y , z\right\} \\
	&= \left\{ \epsilon \mid G(x - \epsilon) - \epsilon \leq F(x) \leq G(x + \epsilon) + \epsilon, \forall x \right\}
\end{align*}
であるので$\inf$を取る対象となる集合が変わらないため$\rho\left( F, G \right) = \rho\left( G, F \right)$である。

\subsection{非負性}
$\rho\left( F, G \right) < 0$とすると実数の連続性より$\rho\left( F, G \right) < \alpha < 0$なる実数$\alpha$が必ず存在し、この時以下が満たされる。
\begin{align*}
	\forall x, F\left( x - \alpha \right) - \alpha \leq G(x) \leq F\left( x + \alpha \right) + \alpha
\end{align*}
しかし、$x - \alpha > x > x + \alpha$であるので、分布関数の定義より$F(x-\alpha) \geq F(x + \alpha)$であり、さらに$F(x-\alpha) -\alpha \geq F(x + \alpha) + \alpha$である。これは先と矛盾するので$\rho\left( F, G \right) \geq 0$である。

\subsection{$\rho\left( F, G \right)  =  0 \Leftrightarrow F = G$}
$(\Leftarrow part)$ 
\begin{align*}
	\rho\left( F, G \right) = \inf\left\{ \epsilon \mid F(x-\epsilon) - \epsilon \leq F(x) \leq F(x+\epsilon) + \epsilon, \forall x \right\}
\end{align*}
任意の$\epsilon \geq 0$について$F(x-\epsilon) \leq F(x), F(x + \epsilon) \geq F(x)$であるので、$\inf$を取る集合は任意の$\epsilon \geq 0$を含む。非負であることは先に示したので、この時確かに$\rho\left( F, G \right)  =  0$である。

\noindent $(\Rightarrow part)$
\begin{align*}
	F(x - \epsilon) - \epsilon \leq G(x) \leq F(x + \epsilon) + \epsilon
\end{align*}
に対して$\epsilon \to 0$とすると、仮定より$F(x_{-}) \leq G(x) \leq F(x_{+})$が成立する。これより、もし$x$が$F$の連続点であれば、$G(x) = F(x)$である。また、もし$x$が連続点でない場合出会っても、不連続点が高々可算個しかないことから上から不連続点$x$に近づく連続点の列$\left\{ x_m \right\}$を考えることができ、分布関数の右連続性と、連続点においては$F.G$が等しいという先の結果より、
\begin{align*}
	G(x) = G(x_{+}) = \lim_{x_m \downarrow x} G(x_m) = \lim_{x_m \downarrow x} F(x_m) = F(x_{+}) = F(x)
\end{align*}
となり、不連続点においても$F = G$となることが確認できる。

\section{3.2.9}

\section{3.2.11}

\section{3.2.12}

\section{3.2.13}

\section{3.2.14}


\end{document}

























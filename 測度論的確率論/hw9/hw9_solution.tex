\documentclass{article}
\usepackage[margin = .7in]{geometry}
\usepackage[dvipdfmx]{graphicx}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{bm}
\usepackage{mathrsfs}
\lstset{%
  language={python},
  basicstyle={\small},%
  identifierstyle={\small},%
  commentstyle={\small\itshape},%
  keywordstyle={\small\bfseries},%
  ndkeywordstyle={\small},%
  stringstyle={\small\ttfamily},
  frame={tb},
  breaklines=true,
  columns=[l]{fullflexible},%
  numbers=left,%
  xrightmargin=0zw,%
  xleftmargin=3zw,%
  numberstyle={\scriptsize},%
  stepnumber=1,
  numbersep=1zw,%
  lineskip=-0.5ex%
}

\begin{document}
\title{測度論的確率論 2018 S1S2 \\ 
Homework 9}
\author{経済学研究科現代経済コース修士1年 / 池上　慧 (29186009) / sybaster.x@gmail.com}
\maketitle

\section{2.3.11}
まず$X_n \xrightarrow{p} 0\ \Leftrightarrow\ p_n \to 0$を示す。右側を仮定する。この時、任意に$\epsilon, \delta > 0$を取ると、
\begin{align*}
	\exists N\ \text{s.t.}\ n\geq N\ \Rightarrow\ P\left( |X_n| > \delta \right) = P(X_n = 1) = p_n < \epsilon
\end{align*}
であるので確率収束の定義より確かに$X_n \xrightarrow{p} 0$である。逆に左側を仮定すると、任意の$\epsilon, \delta > 0$に対して
\begin{align*}
	\exists N\ \text{s.t.}\ n\geq N\ \Rightarrow\ p_n = P(X_n = 1) = P(|X_n| > \delta) < \epsilon
\end{align*}
であるので収束の定義より確かに$p_n \to 0$である。

次に$X_n \to 0\ \text{a.s.}\ \Leftrightarrow\ \sum_n p_n < \infty$を示す。右側を仮定する。この時、$A_n = \left\{ |X_n| > \epsilon \right\}$とすると、
\begin{align*}
	\sum_n p_n = \sum_n P(A_n) < \infty
\end{align*}
なのでBorel-Cantelliより$P(A_n\ \text{i.o.}) = 0$であり、$P(A_n\ \text{i.o.}) = 0\ \Leftrightarrow\ X_n\ \to 0 \ \text{a.s.}$より確かに日代理側が成立する。次に逆向きを示す。$A_n$が独立な事象であることからTheorem 2.3.7より、
\begin{align*}
	\sum_n p_n = \sum P(A_n) = \infty\ \Rightarrow\ P(A_n\ \text{i.o.}) = 1
\end{align*}
である。この対偶は、
\begin{align*}
	P(A_n\ \text{i.o.}) < 1\ \Rightarrow\ \sum_n p_n < \infty
\end{align*}
であり、今仮定より$P(A_n\ \text{i.o.}) = 0$なので上の結果より確かに右側が成立する。

\section{2.3.13}
何らかの正の無限大に発散する正実数列$\left\{ c_n \right\}$に対して、任意に$\epsilon > 0$を取ったときに$P\left( \frac{|X_n|}{c_n} > \epsilon\ \text{i.o.} \right) = 0$とできることを示す。Borel-Cantelliより、そのためには$\sum_n P\left( \frac{|X_n|}{c_n} > \epsilon \right) < \infty$とできることを示せば良い。すなわち足していく確率を級数が収束するように十分小さく抑えれば良い。
\begin{align}
	P\left( \frac{|X_n|}{c_n} > \epsilon \right) = P\left( \frac{|X_n|}{\epsilon} > c_n \right) \leq \frac{1}{2^n}
\end{align}
これを満たすような$c_n\to \infty$が存在すれば、$\sum_n \frac{1}{2^n} < \infty$なので題意は示される。以下ではこのような正実数列$\left\{ c_n \right\}\to \infty$が存在することを確認する。

まず各$n$について$(1)$を満たす$c_n$が存在することを確認する。$X_n$は$\mathbb{R}$ valued 確率変数であるので$\frac{|X_n|}{\epsilon} < \infty$である。従って、
\begin{align*}
	P\left( \frac{|X_n|}{\epsilon} > c \right)\to 0\ \text{as}\ c\to \infty
\end{align*}
である。この事実より、$(1)$を満たす$c_n$は各$n$について存在する。さらにこのような$c_n$について、
\begin{align*}
	P\left( \frac{|X_n|}{c_n} \leq \epsilon \right) \geq 1-\frac{1}{2^n}
\end{align*}
であるので、両辺$n\to \infty$とすると、
\begin{align*}
	\lim_{n\to \infty} P\left( \frac{|X_n|}{c_n} \leq \epsilon \right)= 1
\end{align*}
である。$c_n \to \infty$であるとき$\frac{1}{c_n} \to 0$であるので確かに上の式を満たす。以上より条件を満たす正の実数列$\left\{ c_n \right\}$が必ず存在することがわかった。

\section{2.3.14}
$\sup X_n < \infty\ \text{a.s.}\ \Leftrightarrow\ \sum_n P\left( X_n > A \right) < \infty\ \text{for some $A$}$を示す。右側を仮定すると、Borel-Cantelliとドモルガンの定理から
\begin{align*}
	\sum_n P\left( X_n > A \right) < \infty\ \Rightarrow\ P\left( X_n > A\ \text{i.o.} \right) = 0 = P\left( X_n \leq A\ \text{a.a.} \right) = 1
\end{align*}
である。ただしここで$a.a.$はDurrettにおける$\liminf A_n$に対応する記号であるとする。これは確かに左側が成立していることを意味している。逆向きは対偶を示す。すなわち、
\begin{align*}
	\forall A, \sum_n P\left( X_n > A \right) = \infty\ \Rightarrow\ P\left( \sup X_n < \infty \right) < 1
\end{align*}
を示す。任意に$A$を取って、$X_n$が独立な確率変数であることに注意すると、$X_n > A$という事象も独立であるのでTheorem 2.3.7より、
\begin{align*}
	\sum_n P\left( X_n > A \right) = \infty\ \Rightarrow\ P\left( X_n > A\ \text{i.o.} \right) = 1
\end{align*}
が成立する。これは$X_n$が確率$1$で任意の$A$をどこかの$n$で上回ることを意味しているので確かに$P\left( \sup X_n < \infty \right) = 0 < 1$が満たされる。以上で題意は示された。

\section{2.5.9}
まず$P\left( \max_{m<j\leq n} \left|S_{m,j}\right| > 2a \right)$について考える。
\begin{align*}
	A_j = \left\{ \omega\mid \left| S_{m,j} \right| > 2a\ \text{and}\ \left| S_{m,i} \right| \leq 2a\ m < \forall i < j \right\}
\end{align*}
とするとこれは独立な事象である。ここで、
\begin{align*}
	P\left( \max_{m<j\leq n} \left|S_{m,j}\right| > 2a \right) = P\left( \bigcup_{j=m+1}^n A_j \right) \leq \sum_{j=m+1}^n P\left( A_j \right)
\end{align*}
とできるので、
\begin{align*}
	P\left( \max_{m<j\leq n} \left|S_{m,j}\right| > 2a \right) \min_{m<k \leq n}P\left( \left| S_{k, n} \right| \leq a \right) &\leq \left(\sum_{j=m+1}^n P\left( A_j \right) \right)  \min_{m<k \leq n}P\left( \left| S_{k, n} \right| \leq a \right)\\[10pt]
	&\leq \sum_{j=m+1}^n P\left( A_j \right) P\left( \left| S_{j,n} \right| \leq a \right)
\end{align*}
を得る。ここで、$A_j$は$\sigma\left\{ X_{m+1}, \cdots, X_j \right\}$に含まれていて、$\left\{ \left| S_{j,n} \right| \leq a \right\}$は$\sigma\left\{ X_{j+1}, \cdots, X_n \right\}$に含まれている。つまりこれらの事象は独立であるので、$P\left( A_j \right) P\left( \left| S_{j,n} \right| \leq a \right) = P\left( A_j \ \text{and}\ \left| S_{j,n} \right| < a \right)$である。さらに、$\left| S_{j,n} \right| \leq a$かつ$ \left| S_{m,j} \right| > 2a$であれば$ \left| S_{m,n} \right| > a$であるので、
\begin{align*}
	P\left( A_j \ \text{and}\ \left| S_{j,n} \right| < a \right) \leq P\left( A_j \ \text{and}\ \left| S_{m,n} \right| > a \right)
\end{align*}
である。以上の議論より、
\begin{align*}
	P\left( \max_{m<j\leq n} \left|S_{m,j}\right| > 2a \right) \min_{m<k \leq n}P\left( \left| S_{k, n} \right| \leq a \right) &\leq \sum_{j=m+1}^n P\left( A_j \ \text{and}\ \left| S_{m,n} \right| > a \right)\\[10pt]
	&\leq P\left( \left| S_{m,n} \right| > a \right)
\end{align*}
ただし最後の不等式は$A_j$がそれぞれ排反な事象であることによるものである。以上で題意の不等式が示された。

\section{2.5.10}
Ex 2.5.9を使うと、任意の$a,m > 0$について以下の不等式を得る。
\begin{align}
	P\left( \max_{m<j\leq n} \left|S_{m,j}\right| > 2a \right) \leq\frac{P\left( \left| S_n -S_m \right| > a \right)}{\min_{m<k \leq n}P\left( \left| S_{k, n} \right| \leq a \right)}
\end{align}
まず右辺の分子について考える。$S_n$の確率収束する先を$S$と書くと、三角不等式より以下が成立する。
\begin{align*}
	P\left( \left| S_n - S_m \right| > a \right) \leq P\left( \left| S_n - S \right| > \frac{a}{2} \right) + P\left( \left| S_m - S \right| > \frac{a}{2} \right)
\end{align*}
ここで両辺$n\to \infty$とすると、確率収束の定義より
\begin{align*}
	\lim_{n\to \infty} P\left( \left| S_n - S_m \right| > a \right) \leq P\left( \left| S_m - S \right| > \frac{a}{2} \right)
\end{align*}
を得る。$(2)$の右辺分母に対しては、
\begin{align*}
	\min_{m<k \leq n}P\left( \left| S_n - S_k \right| \leq a \right) &= 1 - \max_{m<k\leq n} P\left( \left| S_n - S_k \right| > a \right)\\[8pt]
	&\geq 1 - \max_{m<k\leq n} \left[ P\left( \left| S_n - S \right| > \frac{a}{2} \right) + P\left( \left| S_k - S \right| > \frac{a}{2} \right) \right]\\[8pt]
	&\geq 1 - 2 \sup_{l > m} P\left( \left| S_l - S \right| > \frac{a}{2} \right)
\end{align*}
が得られる。ただし一つ目の不等号は三角不等式より、二つ目の不等式は最大値の候補となる個数を増やしたことにより得られる。以上の結果より、$(2)$からさらに以下の不等式が得られる。
\begin{align}
	\lim_{n\to \infty}P\left( \max_{m<j\leq n} \left|S_j - S_m\right| > 2a \right) \leq \frac{P\left( \left| S_m - S \right| > \frac{a}{2} \right)}{1 - 2 \sup_{l > m} P\left( \left| S_l - S \right| > \frac{a}{2} \right)}
\end{align}
ここで$\left\{ \max_{m<j\leq n} \left|S_{m,j}\right| > 2a  \right\}$は$n$が増えると$2a$を超える候補が増えていくので増大列である。従って、
\begin{align*}
	\lim_{n\to \infty}P\left( \max_{m<j\leq n} \left|S_j - S_m\right| > 2a \right) = P\left( \sup_{l > m}  \left|S_l - S_m\right| > 2a \right)
\end{align*}
が成立する。これより$(3)$から以下の不等式が得られる。
\begin{align*}
	P\left( \sup_{l > m}  \left|S_l - S_m\right| > 2a \right) \leq \frac{P\left( \left| S_m - S \right| > \frac{a}{2} \right)}{1 - 2 \sup_{l > m} P\left( \left| S_l - S \right| > \frac{a}{2} \right)}
\end{align*}
この両辺で$m \to \infty$にすることを考える。$S_m \xrightarrow{p} S$であることより、右辺分子は$0$に、右辺分母は$1$に収束する。従って、
\begin{align}
	\lim_{m \to \infty} P\left( \sup_{l > m}  \left|S_l - S_m\right| > 2a \right)  = 0
\end{align}
である。

$\left\{S_n(\omega)\right\}$が確率$1$でコーシー列であることを示せば、実数の完備性より$\lim_{n\to \infty} S_n$が確率$1$で存在する。よって以下では$(4)$を用いて$\left\{S_n(\omega)\right\}$が確率$1$でコーシー列であることを示す。まず、
\begin{align*}
	\sup_{j,k > m} \left| S_j - S_k \right| > 4a\ \Rightarrow\ \sup_{j,k > m} \left| S_j - S_m \right| + \left| S_k - S_m \right| > 4a\ \Rightarrow\ 2 \sup_{l > m} \left| S_l - S_m \right| > 4a\ \Rightarrow\ \sup_{l > m} \left| S_l - S_m \right| > 2a
\end{align*}
であることより、
\begin{align*}
	P\left( \sup_{j,k > m} \left| S_j - S_k \right| > 4a \right) \leq P\left( \sup_{l > m} \left| S_l - S_m \right| > 2a \right)
\end{align*}
である。これと$(4)$の結果より、
\begin{align*}
	\lim_{m \to \infty} P\left( \sup_{j,k > m} \left| S_j - S_k \right| > 4a \right) = 0
\end{align*}
である。$a > 0$は任意に取れるので、$T_m = \sup_{j,k > m} \left| S_j - S_k \right|$と新たに確率変数を置いた時に、上の式は$T_m \xrightarrow{p} 0$を意味する。また$T_m(\omega)$は事象$\omega$を固定した時に$m$についての単調減少な列となる。ここで以下の二つを基本的な結果として用いる。
\begin{itemize}
	\item $T_m \xrightarrow{p} 0\ \Rightarrow\ \left\{ T_{m_k} \right\}_{k=1}^{\infty}$で$0$にa.s.で収束するものが存在する。
	\item 単調な数列の部分列の収束先は元の数列の収束先と同じになる。
\end{itemize}
これらより$T_m \to 0\ \text{a.s.}$であることがわかる。すなわち、$P\left( \left\{ \omega\mid T_m(\omega) \to 0 \right\} \right) = 1$である。$T_m$の定義より、
\begin{align*}
	T_m(\omega) \to 0\ \Leftrightarrow\ \lim_{m\to \infty} \sup_{j,k > m} \left| S_j(\omega) - S_k(\omega) \right| = 0
\end{align*}
である。ここで、
\begin{align*}
	\lim_{m,n \to \infty} \left| S_m(\omega) - S_n(\omega) \right| \leq \lim_{m\to \infty} \sup_{j,k > m} \left| S_j(\omega) - S_k(\omega) \right| = 0
\end{align*}
であるので確かに$\left\{S_n\right\}$が確率$1$でコーシー列であることが示され、よって題意は示された。


\section{2.5.11}

\end{document}

































\documentclass{article}
\usepackage[margin = .7in]{geometry}
\usepackage[dvipdfmx]{graphicx}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{bm}
\usepackage{mathrsfs}
\lstset{%
  language={python},
  basicstyle={\small},%
  identifierstyle={\small},%
  commentstyle={\small\itshape},%
  keywordstyle={\small\bfseries},%
  ndkeywordstyle={\small},%
  stringstyle={\small\ttfamily},
  frame={tb},
  breaklines=true,
  columns=[l]{fullflexible},%
  numbers=left,%
  xrightmargin=0zw,%
  xleftmargin=3zw,%
  numberstyle={\scriptsize},%
  stepnumber=1,
  numbersep=1zw,%
  lineskip=-0.5ex%
}

\begin{document}
\title{測度論的確率論 2018 S1S2 \\ 
Homework 11}
\author{経済学研究科現代経済コース修士1年 / 池上　慧 (29186009) / sybaster.x@gmail.com}
\maketitle


\section{Ex11.6}
確率変数列$\left\{ X_n : n \in \mathbb{N}\right\}$に対して$\left\{ \mathcal{L}(X_n) : n \in \mathbb{N} \right\}$が一様にタイトであることを仮定する。この時、任意に$\epsilon > 0$と$c_n \to 0$を取ると、
\begin{align*}
	P\left( \left| c_n X_n \right| \geq \epsilon \right) = P\left( \left| X_n \right| \geq \frac{\epsilon}{|c_n|} \right)
\end{align*}
であるので、任意の$\delta > 0$に対してある$N \geq 0$が存在して以下を満たす。
\begin{align*}
	n\geq N\ \Rightarrow\ P\left( \left| c_n X_n \right| \geq \epsilon \right) \leq P\left( \left| X_n \right| \geq \frac{\epsilon}{\delta} \right) = 1-\mathcal{L}(X_n)\left( \frac{\epsilon}{\delta} \right) + \mathcal{L}(X_n)\left(- \frac{\epsilon}{\delta} \right)
\end{align*}
つまり、
\begin{align*}
	\forall \epsilon,M > 0, \exists N\ \text{s.t.}\ n\geq N\ \Rightarrow\ P\left( \left| c_n X_n \right| \geq \epsilon \right) \leq 1-\mathcal{L}(X_n)\left( M \right) + \mathcal{L}(X_n)\left(-M \right)
\end{align*}
である。一葉タイト性の仮定より、任意の$n$について上式の右辺を任意に小さい$\eta$で上から抑えることのできる$M$が必ず存在するので、
\begin{align*}
	\forall \epsilon, \eta > 0,\ \exists N\ \text{s.t.}\ n\geq N\ \Rightarrow\ P\left( \left| c_n X_n \right| \geq \epsilon \right) \leq \eta
\end{align*}
が成立し、これは確率収束の定義から$c_nX_n\xrightarrow{p}0$を意味する。

\noindent
次に逆向きを示す。すなわち任意の$c_n \to 0$に対して$c_n X_n \xrightarrow{p} 0$が成立することを仮定する。これは以下を意味する。
\begin{align*}
	\forall \epsilon , \delta > 0,\ \exists N\ \text{s.t.}\ n\geq N\ \Rightarrow\ 1-\mathcal{L}(X_n)\left( \frac{\epsilon}{\left| c_n \right|} \right) + \mathcal{L}(X_n)\left( -\frac{\epsilon}{\left| c_n \right|} \right) \leq \delta
\end{align*}
また、$c_n\to 0$であることより、
\begin{align*}
	\forall \epsilon , M_{\delta} > 0, \ \exists N_1\ \text{s.t.}\ n\geq N_1\ \Rightarrow\ \left| c_n \right| \leq \frac{\epsilon}{M_{\delta}}
\end{align*}
である。よって、$N^{\star} = \max\left\{ N, N_1 \right\}$と置くと、
\begin{align*}
	\forall \delta, M_{\delta} > 0, \  n\geq N^{\star} \ \Rightarrow\ P\left( \left| X_n \right| \geq M_{\delta} \right) = 1-\mathcal{L}(X_n)\left( M_{\delta} \right) + \mathcal{L}(X_n)\left(- M_{\delta} \right) \leq \delta
\end{align*}
であり、これより$X_n\xrightarrow{p}0$である。確率収束するならば分布収束するので$X_n\xrightarrow{d}0$であり、Th11.7より分布収束する確率変数列は明らかに一様タイトなので題意は示された。

\section{Ex12.2}
${\rm Var}(X_{n,m}) = {\rm E}\left[ \left( X_{n,m} - \theta_n \right)^2 \right]$と置いて、以下の変数を考える。
\begin{align*}
	Y_{n,m} = \frac{X_{n,m} - \theta_n}{\sqrt{n} \sqrt{{\rm Var}(X_{n,m})}}
\end{align*}
これに対して、${\rm E}\left[ X_{n,m} \right] = \theta_n$であることより、
\begin{align*}
	{\rm E}\left[ Y_{n,m} \right] = \frac{{\rm E}\left[ X_{n,m} \right] - \theta_n}{\sqrt{n} \sqrt{{\rm Var}(X_{n,m})}} = 0
\end{align*}
である。また、
\begin{align*}
	 \sum_{m=1}^n{\rm E}\left[ Y_{n,m}^2 \right] =\sum_{m=1}^n \frac{{\rm E}\left[ \left( X_{n,m} - \theta_n \right)^2 \right]}{n{\rm Var}(X_{n,m})} = 1
\end{align*}
である。あとはこの確率変数に対してのLindeberg条件を確認すれば良い。
\begin{align*}
	g_n(\epsilon) &= \sum_{m=1}^n {\rm E} \left[ \frac{ \left( X_{n,m} - \theta_n \right)^2}{n{\rm Var}(X_{n,m})} 1\left\{  \frac{X_{n,m} - \theta_n}{\sqrt{n} \sqrt{{\rm Var}(X_{n,m})}} > \epsilon \right\} \right]\\[8pt]
	&= {\rm E}\left[  \frac{ \left( X_{n,m} - \theta_n \right)^2}{{\rm Var}(X_{n,m})} 1\left\{  \frac{X_{n,m} - \theta_n}{\sqrt{{\rm Var}(X_{n,m})}} > \epsilon \sqrt{n} \right\} \right]
\end{align*}
とおく。ここで、
\begin{align*}
	{\rm E}\left[  \frac{ \left( X_{n,m} - \theta_n \right)^2}{{\rm Var}(X_{n,m})}  \right] = 1 < \infty
\end{align*}
なので優収束定理が適用でき、$\lim_n g_n(\epsilon) = 0$である。これよりLindeberg条件は満たされるので、Th12.1より
\begin{align*}
	\sum_{m=1}^n \frac{X_{n,m} - \theta_n}{\sqrt{n} \sqrt{{\rm Var}(X_{n,m})}}\ \xrightarrow{d}\ N(0,1)
\end{align*}
である。仮定より${\rm Var}(X_{n,m}) \to 1$であるので、スラツキーの定理より、
\begin{align*}
	\frac{1}{\sqrt{n}} \sum_{m=1}^n (X_{n,m} - \theta_n) = \sqrt{n} (\bar{X_n} - \theta_n) \xrightarrow{d}\ N(0,1)
\end{align*}
である。

\section{Ex12.3}
十分大きな$n$に対して、$\sup_{x\in \mathbb{R}} \left| P\left( \frac{S_n}{\sqrt{n}} \leq x \right) - \Phi(x) \right|$を与える$x$について考える。対称性より$x \geq 0$についてのみ考えれば良い。まず、部分積分によって標準正規分布の分布関数について以下の表現をえる。
\begin{align}
	\Phi(x) = \frac{1}{2} + \frac{1}{\sqrt{2\pi}} e^{- \frac{x^2}{2}} \left[ x + \frac{x^3}{3} + \frac{x^5}{3\times 5} + \cdots + \frac{x^{2m+1}}{(2m+1)!!} + \cdots \right]
\end{align}

$n$が奇数の時をまず考える。$S_n$の定義より$P\left( S_n \leq x \sqrt{n} \right)$は、$k\in\mathbb{N}$に対して$\left[ \frac{2k-1}{\sqrt{n}}, \frac{2k+1}{\sqrt{n}} \right)$の範囲で定数$\frac{1}{2} + \sum_{i=1, i\ \text{is odd}}^{2k-1} \frac{1}{2} \frac{1}{2^n} {}_n \mathrm{C} _\frac{n-i}{2}$を取る。ここで十分大きな$n$においては以下の関係が成立する。
\begin{align*}
	\sum_{i=1, i\ \text{is odd}}^{2k-1} \frac{1}{2} \frac{1}{2^n} {}_n \mathrm{C} _\frac{n-i}{2} \leq \Phi \left(\frac{2k-1}{\sqrt{n}} \right)
\end{align*}
なぜなら、スターリングの公式と$(1)$より十分大きな$n$において
\begin{align*}
	\sum_{i=1, i\ \text{is odd}}^{2k-1} \frac{1}{2} \frac{1}{2^n} {}_n \mathrm{C} _\frac{n-i}{2} - \Phi \left(\frac{2k-1}{\sqrt{n}} \right) &= \frac{1}{\sqrt{2\pi n}} \left\{ \left( \frac{1}{2} \sum_{i=1, i\ \text{is odd}}^{2k-1} e^{-\frac{i}{2n}}\right) - e^{- \frac{(2k-1)^2}{2n}} \left( 2k-1 + \frac{1}{3} \frac{1}{n} (2k-1)^3 + \cdots \right) \right\}\\[10pt]
	&\leq \frac{1}{\sqrt{2\pi n}} e^{- \frac{(2k-1)^2}{2n}} (2k-1) \left\{ \frac{k}{2} \frac{1}{2k-1}\exp \left(2 \frac{k(k-1)}{n}\right) - \left(1 + \frac{1}{3} \frac{1}{n} (2k-1)^2 + \cdots \right) \right\}\\[10pt]
	&\to \frac{k}{2(2k-1)} -1 \leq 0\ \forall k
\end{align*}
となるからである。これより、十分大きな$n$においては任意の$k \leq \frac{n+1}{2}$に対して、$x \geq 0$における$P\left( S_n \leq \sqrt{n} x \right)$が定数となる$k$番目の区間は収束先の$\Phi(x)$よりも下に位置することがわかった。

また、$k < \frac{n}{2}$について、
\begin{align}
	\frac{{}_n \mathrm{C} _{k-1}}{{}_n \mathrm{C} _{k}} = \frac{k}{n-k+1} < 1
\end{align}
であることから、奇数の$n$について、
\begin{align*}
	\frac{{}_n \mathrm{C} _\frac{n-1}{2}}{2^n},\ \frac{{}_n \mathrm{C} _\frac{n-3}{2}}{2^n},\ \frac{{}_n \mathrm{C} _\frac{n-5}{2}}{2^n}, \cdots
\end{align*}
なる列は単調減少の列であることがわかる。すなわち$x\geq 0$における$P\left( S_n \leq \sqrt{n} x \right)$のジャンプは最初のジャンプが一番大きくなることがわかった。

$\Phi(0) = \frac{1}{2}$であり、$n$が奇数の時必ず$P\left( S_n \leq 0 \right) = \frac{1}{2}$となっているので、以上二つの事実をから、$n$についての$\liminf$を取るのであれば$x\geq0$における最初のジャンプ大きさの極限を考えれば良いことがわかった。

次に$n$が偶数で十分大きいときを考える。このときは$x=0$でジャンプが起こるので奇数の時とは少し事情が異なるので注意が必要である。定義より$0\leq k\leq \frac{n}{2}$として$x\in \left[ \frac{2k}{\sqrt{n}}, \frac{2k+2}{\sqrt{n}} \right)$において$P\left( S_n \leq \sqrt{n} x \right) = \frac{1}{2} + \sum_{i=0,\ \text{i is even}}^{2k} \frac{1}{2} \frac{1}{2^n} {}_n \mathrm{C} _\frac{n-i}{2}$である。奇数の時と同様に収束先の$\Phi(x)$との大小を比較すると以下の結果が得られる。
\begin{align*}
	\begin{cases}
	\Phi(x) \leq \frac{1}{2} + \sum_{i=0,\ \text{i is even}}^{2k} \frac{1}{2} \frac{1}{2^n} {}_n \mathrm{C} _\frac{n-i}{2} & \text{when}\ k=0\\[8pt]
	\Phi(x) \geq \frac{1}{2} + \sum_{i=0,\ \text{i is even}}^{2k} \frac{1}{2} \frac{1}{2^n} {}_n \mathrm{C} _\frac{n-i}{2} & \text{otherwise}
	\end{cases}
\end{align*}

\section{Ex12.4}
以下のような確率変数列$\left\{ Y_n \right\}$を考える。ただし$p\in (0,1)$とする。
\begin{align*}
\begin{cases}
	P\left( Y_n = 1 \right) = p\\[8pt]
	P\left( Y_n = 0 \right) = 1-p
\end{cases}
\end{align*}
この時、$S_n = \sum_{m=1}^n Y_m$として、$X_n = \frac{S_n -np}{\sqrt{npq}}$とおくと、ド・モアブル-ラプラスの定理からこれは標準正規分布に分布収束する。収束先を$X$で書くとする。ここで、
\begin{align*}
	A = \left\{ \frac{k-np}{\sqrt{npq}} \mid k \geq 0, n\geq 0, k,n \in \mathbb{N} \right\}
\end{align*}
とすると、$A\in \mathcal{B}$であるが、定義より任意の$n$について$P\left( X_n \in A \right) = 1$であり、同時に$X$は連続確率変数であることより$P\left( X \in A \right) = 0$である。従って全ての$A\in \mathcal{B}$に対して$P\left( X_n \in A \right)\to P\left( X\in A\right)$となるわけではないことがわかった。

\section{Ex12.7}
任意に$\epsilon > 0$を取る。この時、Lyapunov条件における$\delta > 0$に対して、
\begin{align*}
	\left| X_n \right| \geq \epsilon \ \Rightarrow\ \frac{\left| X_n \right|}{\epsilon} \geq 1\ \Rightarrow\ \left(  \frac{\left| X_n \right|}{\epsilon} \right)^{\delta} \geq 1
\end{align*}
である。これより、
\begin{align*}
	\sum_{m=1}^n {\rm E}\left[ X_{n,m}^2 1\left\{ \left| X_{n,m} \right| \geq \epsilon \right\} \right] &\leq \sum_{m=1}^n {\rm E}\left[ X_{n,m}^2  \left(  \frac{\left| X_n \right|}{\epsilon} \right)^{\delta} 1\left\{ \left| X_{n,m} \right| \geq \epsilon \right\} \right] \\[8pt]
	&=\frac{1}{\epsilon^{\delta}} \sum_{m=1}^n {\rm E}\left[ \left| X_{n,m} \right|^{2+\delta} 1\left\{ \left| X_{n,m} \right| \geq \epsilon \right\} \right]\\
	&\leq \frac{1}{\epsilon^{\delta}} \sum_{m=1}^n {\rm E}\left[ \left| X_{n,m} \right|^{2+\delta} \right]
\end{align*}
である。最終行はLyapunov条件が成立する時$n\to \infty$で$0$に収束するので、Lindeberg条件も成立することが確認できた。

\end{document}






















\documentclass{jsarticle}
\usepackage[margin = .7in]{geometry}
\usepackage[dvipdfmx]{graphicx}
\usepackage{listings}
\usepackage{amsmath}
\usepackage{bm}
\lstset{%
  language={python},
  basicstyle={\small},%
  identifierstyle={\small},%
  commentstyle={\small\itshape},%
  keywordstyle={\small\bfseries},%
  ndkeywordstyle={\small},%
  stringstyle={\small\ttfamily},
  frame={tb},
  breaklines=true,
  columns=[l]{fullflexible},%
  numbers=left,%
  xrightmargin=0zw,%
  xleftmargin=3zw,%
  numberstyle={\scriptsize},%
  stepnumber=1,
  numbersep=1zw,%
  lineskip=-0.5ex%
}



\begin{document}
\title{給付型奨学金の効果検証}
\author{Kei Ikegami}
\maketitle

\section{事実}
    \begin{itemize}
    	\item Jassoの予約採用募集時期は5,6月に1種2種、10,11月に2種のみ。在学採用は毎年春。ただし詳しい時期や回数は高校に一任されている。
    \end{itemize}
    
\section{モデルの設定}
	\subsection{モデル1：池上/12/22}
	ナイーブなモデルを設定する。
	\par
	全国の高校生は3年生の5、6月に、以下のプロセスをバックワードに意思決定する。
	\begin{enumerate}
		\item 進学するか否か
		\item 受験する学校（職場）のセットは何か
	\end{enumerate}
	受験する学校のセットは以下のように決定される。$A$を国公立4年生大学、$B$を私立4年生大学、$C$を専門学校の集合とする。$A,B,C$の各学校は奨学金ありと奨学金なしで2パターンずつ存在する。受験生は$A$の中から効用を最大化する選択肢を1つ選び、$B,C$については効用の高い順にランク付けする。$A$から選んだものも含めてすべての選択肢についてのランキングを作成した後、受験生が住んでいる都道府県での受験校平均だけ上から取り出したものを受験校のセットとする（ただし正の値のもののみを含むようにする）。
	\par
	生徒$i$が学校$n$の奨学金なしパターンを選択する効用を$u_n^i$とすると、
	\begin{align*}
		u_n^i = (I_n - H^i - T_n) r_n^i
	\end{align*}
	ただし、$I_n$は学校$n$を卒業した人の平均生涯賃金、$H^i$は$i$さんが住んでいる都道府県の高卒者平均生涯賃金、$T_n$は学校$n$の学費の割引現在価値、$r_n^i$は$i$さんが学校$n$に受かる確率である。\par
	奨学金ありパターンを選択する効用を${u_n^i}^{*}$とすると、
	\begin{align*}
		{u_n^i}^{*} = (u_n^i + S_n^i - P^i - C - \infty * {\bf 1}(X_i \in Q)) r_n^i d^i
	\end{align*}
	ただし、$S_n^i$は$i$さんが学校$n$に進学した際にもらえる奨学金の合計金額の割引現在価値、$P^i$は$i$さんが返済する金額の割引現在価値、$C$は奨学金に申し込むコスト、$X_i$は$i$さんのdemographicで$Q$が奨学金をもらえないdemographicの集合である。また、$d_n^i$は$i$さんの奨学金採用確率である。
	\par
	上で述べた通り、学生は各学校について上の二つの効用を比べ、効用最大化問題を解いている。
	\par
	進学せずに就職するやつの数を、「受験校のセットが空集合の受験生の数」+「(各学校に対する合格率で当落を判定し、すべて不合格になった受験生の数)×$\ w$」（ただし$w$は全落ちしたやつが浪人せずに就職する確率）で推定する。上の効用をパラメトライズして、この高卒就職組の数を高校別or県別に出してMLEをすればいい？
	
	\subsection{モデル1改良:池上12/24,5}
	\par
	モデル1をもう少しspecificにする。
	\begin{itemize}
		\item 意思決定に自宅通学か下宿かの分岐を入れ込んじゃう
		\item 大学のcharacteristicsとして「関関同立」のような世間一般に受け入れられている格付けをを追加
		\item specficationとして各大学の受験生獲得シェアの学費弾力性のようなものを推定するようにパラメトライズする。→この文脈だと国公立に絞った方が嬉しいかも？（一つしか選べないので）
	\end{itemize}
	\par
	疑問としては次のものがある。
	\begin{itemize}
		\item 流動性制約をこのモデルで扱えているか？
		\item そもそも奨学金もらっている人が少ないし、torbitとかのほうがいいのかな？
	\end{itemize}
	\par
	以下で具体的に書く。
	$s = 0$で自宅通学、$s = 1$で下宿を表す。$a = 0$で奨学金なし、$a = 1$で奨学金受給を表す。$i$さんが学校$n$に$s, a$の状態で通うことの効用を以下のように書く。
	\begin{align*}
	u_{i,n,s,a} = &\left\{ y_n{\bf \beta_i} + \alpha_i \left( T_n - {\bf 1(a = 1)} A_i\right) + \gamma_i H_n + \delta_i {\bf 1(s = 1)} S_n + \eta_i R_i - {\bf 1(a = 1)}\left( {\bf 1(X_i \in Q_n)} * \infty \right) \right\}\\
	 & * r_n(X_i) * \left\{ p(X_i) {\bf 1(a = 1)}\right\}
	\end{align*}
	ここで、$y_n$は学校$n$の、就職という選択肢と比べられる特徴量（例えば生涯賃金）。$T_n$は学校$n$の学費の現在価値、$A_i$は$i$さんが貰える奨学金の現在価値である。$H_n$は学校$n$の「格」を表す指標で、「東大・京大」「早稲田・慶應」などの大学間のランク付けが社旗通念として一般に受け入れられていることから取り入れる価値があると判断した。これは順序付きのカテゴリー変数でもいいし、格ごとのダミー変数でもいい。$S_n$は学校$n$に下宿で通う場合の家賃である。学校周辺のワンルームの平均家賃をデータとして用いる（通っている間の割引現在価値を入れる）。$R_i$は$i$さんが返済する奨学金の金額の割引現在価値である。現在でも返済うる金額には差異が存在しているようなのでその変動を利用する。$X_i$はiさんのdemographicで、$Q$が奨学金の対象である個人のdemographic空間ないの部分集合である。$r_n(X_i)$は$i$さんの学校$n$に対する合格率で、$X_i$の関数で書く。$p(X_i)$は$i$さんの奨学金採用率で、これも$X_i$の関数で書く。式中の${\bf 1}$はindicator functionである。ただし、上式での各パラメータは個人に依存した形にしているので、実際に計算するときはBLPみたいにmean utilityとheteroな部分に分解して計算することになるので注意（めんどくさいしとりあえずhomogeneticなモデルでやるのがいいかも）。
	\par
	先のモデルと同様に、$i$さんの県内での平均受験校数を$N_i$として、国公立から最大の効用をもたらす学校を一つ、私立と専門から効用の大きい順に$N_i -1$個選び、$N_i$この受験校bundleを作る。それと、就職する効用である$u_{i, 0}$とを比べて、就職するシェアを離散選択モデルの文脈で計算する。そのシェアに、bundleに全落ちする学生のうちから何割かを浪人せずに就職する人達として、そのシェアに追加し、全体としての高卒就職率を算出する。
	\par
	浪人せずに就職する割合をbeta分布などからシミュレーションして、Farmanian and Salanie (2004)に基づいてlikelihood functionを作成すし、MLEを求める。（それかそれもパラメータとしてただのMLEでやる）
	
	\subsection{モデル2:池上12/28}
	意思決定の過程は以下のとおり。主体は高校3年生とその世帯とする。
	\par
	まず、高校3年生は以下の2パターンに分類される。
	\begin{enumerate}
		\item 奨学金なしで通うことのできる学校が存在する
		\item 奨学金なしではどの学校にも通うことができない
	\end{enumerate}
	ここで、「通うことのできる学校が存在する」とは実現可能性集合に高校以降の学校が少なくとも一つ含まれている状態を指す。学校に関する情報は完全であることを仮定し、存在するすべての学校に対して世帯ごとに通悪可能かいなかが判断されている状態を想定する。下宿も自宅通学もどちらの可能性も考慮して実現可能か否かは判断されることとする。
	\par
	パターン1の学生はそれぞれ「通うことのできる学校リスト（$A$と呼称）」を入手する。「奨学金がもらえる時に通うことのできる学校リスト（$B$と呼称）」も同時に作成され、その際に以下の3パターンに分割できる。
	\begin{description}
		\item[$1-a$] $A$の中で効用最大化を達成する選択肢が$B$の中で効用最大化を達成する選択肢と一致する。
		\item[$1-b$] $A$と$B$とで効用最大化を達成する選択肢が異なる。
		\item[$1-c$] 奨学金制度をよく知らず、Aしか見ることができない。
	\end{description}
	簡単のために$1-a$は奨学金に申し込まないとする。$1-b$は$B$における最大の効用が受験しないという選択肢の効用を上回った時のみ奨学金への申し込みを行う。奨学金の採択確率は$X_i$を$i$さんのdemographicとして$q(X_i)$でかけるとする。$1-c$は奨学金を申し込まない。
	\par
	また2のパターンの学生は以下の2パターンに分類できる。
	\begin{description}
		\item[$2-a$] 奨学金を知っている。それによって「奨学金があったら通えるリスト($C$と呼称)」が与えられる。
		\item[$2-b$] 奨学金を知らない。
	\end{description}
	この時$2-a$はCにおける最大効用が受験しないという選択肢の効用を上回った時のみ勉強を始め、奨学金に申し込む。$2-b$は受験することはできない。
	\par
	上で、各学生は自分のリストから最大の効用を与える学校と受験しないという選択肢を比べて「勉強を始める」という意思決定を行い、パターンによっては「奨学金に申し込む」という意思決定も行う。次に、彼らは受験をするか否かという意思決定を行うために、自分の受験校のbundleを決定する。このbundleの決定は受験というくじの価値を決めるものである。bundleの決定は単純に、「仮にその学校に受かったとして、受験しないで就職するよりはいいことがありそうだ」と思えないものはbundleに入れない問いうルールに従うとする。$i$さんのbundleにはいる学校の個数は「$i$さんの在住県の学生が受験する学校の平均数」と「受験しないという選択肢よりも大きな効用をもたらす、$i$さんのリスト内にある学校の数」の小さい方と等しいとする。
	\par
	学生たちは次に「受験するかしないか」の意思決定を行う。bundleの決定によりくじの価値が決定したのでこの意思決定を考えることができる。$i$さんのbundleを$B_i$とする。$B_i$には$1,2, \dots, m_i$だけ学校が入っており、それぞれに$r_{i,1}, r_{i,2}, \dots, r_{i,m_i}$が$i$さんの合格率として紐付いており、それぞれの合格した際の効用を$u_{i, 1}, u_{i, 2}, \dots, u_{i, m_{i}}$と表記することとする。
	\par
	bundleないの学校は数字が小さいほど$i$さんにとっての効用が大きいとして、より効用が大きい学校に受かればそれ以下の学校には進学しないとして、すべての学校に落ちた時の効用を$b_{i, 0}$とすると、$B_i$の持つ期待効用は以下のように書ける。
	\begin{align*}
		u_i^* &= r_{i, 1}b_{i, 1} + (1-r_{i, 1})r_{i, 2} b_{i, 2} + \dots + \Pi_{j = 1}^{m_i - 1} (1 - r_{i, j}) r_{i, m_{i}} b_{i, m_{i}} + \Pi_{j = 1}^{m_{i}} (1 - r_{i, j}) b_{i, 0} 
	\end{align*}
	今、$u_i$を$i$さんが就職する際の効用として、誤差項にType 1 extreme value distributionを仮定すれば離散選択モデルとして高卒就職を意図的に選択する人のシェアを出すことができる。
	\par
	最後に今まで扱ってきた効用を以下のようにパラメトライズする。$i$さんが学校$j$に奨学金なしで進学し、そこで学位をとることの効用を$u_{i, j}$とし、$i$さんが学校$j$に奨学金付きで進学しそこで学位をとることの効用を$\dot{u_{i, j}}$とする。この時以下のようである。
	\begin{align}
		&u_{i, j} = \alpha_i \sum_{n = 1}^{L_j} \left\{ h^n (y_i^n - t_j - w_i^n) \right\} + \alpha_i \sum_{n = L_j + 1}^{\infty} \left\{ h^n (y_i^n + z_j^n - w_i^n) \right\} + \beta_i d_j + \delta_i C_{i, j} \\
		&\dot{u_{i, j}} = \alpha_i \sum_{n = 1}^{L_j} \left\{ h^n (y_i^n - t_j - w_i^n + s_i) \right\} + \alpha_i \sum_{n = L_j + 1}^{\infty} \left\{ h^n (y_i^n + z_j^n - w_i^n - r_i^n) \right\} + \beta_i d_j + \delta_i C_{i, j} 
	\end{align}
	ここで、
	\begin{description}
		\item[$y_i^n$] 世帯$i$の$n$年後の世帯収入
		\item[$w_i^n$] $i$さんが高卒で就職した際の$n$年後の収入
		\item[$r_i^n$] $i$さんが大学進学して$n$年後に返済する奨学金の額
		\item[$z_j^n$] $j$校を卒業した学生が$n$年後に稼いでいる年収
		\item[$d_j$] $j$校の「格」を示すカテゴリー変数（ダミーにしても良い）
		\item[$C_{i, j}$] $i$さんが$j$校に「合格」し、「学位を所得」するまでに必要な勉強コスト（必要な時間でバイトした時の収入増加分の割引現在価値）
		\item[$L_j$] $j$校で学位をとるまでに必要な年限
		\item[$h$] 割引率
	\end{description}
	である。
\end{document}
































